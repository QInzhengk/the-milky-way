@[TOC](Python正则表达式（re模块）)

# 概述
## 正则表达式
英文名为**Regular Expression**，又称规则表达式。正则表达式通常被用来检索、替换那些符合某个模式(规则)的文本。
## Python正则表达式

 - Python 自1.5版本起增加了re 模块，它提供 Perl 风格的正则表达式模式。re 模块使Python语言拥有全部的正则表达式功能。同时，re 模块是用c语言写的，其匹配速度非常快。
 - 其中compile函数根据一个模式字符串和可选的标志参数生成一个正则表达式对象。该对象拥有一系列方法用于正则表达式匹配和替换。re模块也提供了与这些方法功能完全一致的函数，这些函数使用一个模式字符串做为它们的第一个参数。

# re模块
## re.match方法
re.match 尝试从字符串的起始位置匹配一个规则，匹配成功就返回match对象，否则返回None。可以使用group()获取匹配成功的字符串。

 - 语法：`re.match(pattern, string, flags=0)`
 - 参数说明：

![在这里插入图片描述](/e4ea52c3f4dc4352bc660affa53ec51e.png)


示例1（无标志位）：

![在这里插入图片描述](/9638191b7e214ebab4753a51fa096597.png)


示例2（有标志位）：

![在这里插入图片描述](/8612987314b248b7b9735c3ca06d7826.png)

 - 如果同时使用多个标志位使用|分割，比如re.I | re.M
 - flags可选标志位

![在这里插入图片描述](/93421fa1b9e041f1bfe0ce69f9c81d04.png)

 - 我们可以使用group(num) 或 groups() 匹配对象函数来获取匹配表达式。

![在这里插入图片描述](/9c387c0c8dde49338d77013215138021.png)


示例：

![在这里插入图片描述](/6d788846cf5e46368ac1a647d3b09313.png)

## 常用的匹配规则-匹配字符

![在这里插入图片描述](/3884ee697a234508aaeace21691d7e60.png)

 - .(点)： 匹配任意除换行符之外的字符

![在这里插入图片描述](/a9ddf351e3044a56bb159123d4a771ad.png)

[ ] ：匹配中括号内的任意一个字符

![在这里插入图片描述](/5297494aef644993bed108a714830d48.png)

 - \d ：匹配一个数字

![在这里插入图片描述](/5576f089f74141d98b6720ee709dd652.png)

 - \D 匹配非数字，即不是数字

![在这里插入图片描述](/f1899d64da3241e9a282afe4964f4ea3.png)

 - \s 匹配空白字符串

![在这里插入图片描述](/5d9a4ba846084234b60555c7b883b63c.png)

 - \S 匹配非空白字符
 - \W 匹配非单词字符
 - \w 匹配单词字符，即a-z、A-Z、0-9、_


## 常用的匹配规则-匹配字符数量

 - *：匹配前一个字符出现0次或者无限次，即可有可无
 - ：使用实例，写一个正则匹配python变量名（变量名的语法规则：不能以数字开头，变量名只能包含字母，数字，下划线）
 - ？：使用实例，匹配0-99的数字
 - {n,m} ：匹配前一个字符出现从n到m次,使用实例，匹配qq邮箱

![在这里插入图片描述](/9d354552658044acbe51c861f57c5f7e.png)

## 常用的匹配规则-原生字符串
python字符串中\作为转义字符开头，比如\n表示换行，\t表示tab键，为了表示\本身，再加一个\，成为\形式在python中表示路径‘G:\py资料\1-上课资料\4-正则表达式课件\html’

![在这里插入图片描述](/a808f149965f495a908fcb3f1b2bd8bf.png)

 - 下面使用正则表达式来匹配路径
 - 正则表达式里使用"“作为转义字符，这就可能造成反斜杠困扰。假如你需要匹配文本中的字符”"，那么使用编程语言表示的正则表达式里将需要4个反斜杠""。
 - 在python中有原生字符串，在字符串前面加上r表示字符串中的\不转义。

## 常用的匹配规则-匹配开头结尾

示例：匹配163.com的邮箱地址

![在这里插入图片描述](/b35d7383da9b44d3a599ed4b69ce0692.png)

## 常用的匹配规则- 分组匹配

 - |：匹配出0-100之间的数字

![在这里插入图片描述](/9deb8e4780a344dd9c33917bb0094701.png)

 - (ab) 分组：分别匹配电号码区号和电话号码

![在这里插入图片描述](/3c3aa240c37f4edc9df4aec7c276f9dc.png)

 - \ ：匹配html中的文本
 - 其实我们发现html的标签都是成对出现的，这样匹配规则html就可以引用组来实现，避免重复写。
 - 在使用组引用的时候如果有多个组就容易造成混乱，比如下面多个组引用，这样很混乱也不容易阅读

![在这里插入图片描述](/c5b1ee0f48524dfc937abb2cc2a9285e.png)


解决上面这个问题得给分组起别名

 - (?P)分组起别名
 - (?P=name)引用别名为name分组匹配到的字符串

![在这里插入图片描述](/2b912ae2883d4c5d8d380c23c8bfd438.png)

注：(?P)和(?P=name)中的字母P大写
## re.compile方法
compile 将正则表达式模式编译成一个正则表达式对象

 - reg = re.compile(pattern) result = reg.match(string)
 - 等效于 result = re.match(pattern, string)
 - 使用re.compile()和保存所产生的正则表达式对象重用效率更高

## re.search方法
search 在全文中匹配一次，匹配到就返回

 - 语法：`re.search(pattern, string, flags=0)`
 - 函数参数说明：

示例：扫描字符串，寻找的第一个由该正则表达式模式产生匹配的位置，并返回相应的MatchObject实例。

![在这里插入图片描述](/bc80561c766c4169b136407eb81717dd.png)

## re.findall方法
findall 匹配所有返回一个列表，这个方法使用频率较高。

 - 语法：`findall(string[, pos[, endpos]])`
 - 参数说明：

示例：使用findall来匹配出段子网中的所有段子

![在这里插入图片描述](/e7543628f7784c19ac64a75e22b6666e.png)


通过观察网页源代码，可以看出段子都包含在(.*?)中

![在这里插入图片描述](/2868624e5df6440aa64cf5b6d5674643.png)

## re.sub方法
sub 将匹配到的数据进行替换

 - 语法：`sub(pattern, repl, string, count=0, flags=0)`
 - 参数说明：

![在这里插入图片描述](/21ef2209bbce4b0bb2e97e2c8f1f5f75.png)

示例：

![在这里插入图片描述](/86a86f89785544308cb78e4b6022f01c.png)

## re.split方法
split 根据匹配进行切割字符串，并返回一个列表

 - 语法：`split(pattern, string, maxsplit=0, flags=0)`
 - 参数说明：

![在这里插入图片描述](/58e734a22c77443290678e1992aefd49.png)

示例：


# 贪婪模式与非贪婪模式
## 概述
Python里数量词默认是贪婪的,总是尝试匹配尽可能多的字符,非贪婪则相反，总是尝试匹配尽可能少的字符。
在"*","?","+","{m,n}"后面加上？，使贪婪变成非贪婪.

![在这里插入图片描述](/d50ec3c4eb604c91ab90de9478768b9a.png)


## 案例
匹配淘女郎模特首页所有图片url链接

 - 网站url:

[https://mm.taobao.com/searchtstarmodel.htm?spm=5679.126488.640745.2.24bacb080L6tCt](https://mm.taobao.com/searchtstarmodel.htm?spm=5679.126488.640745.2.24bacb080L6tCt)

 - 图片url

```bash
<img src="//gtd.alicdn.com/sns_logo/i1/TB124_3NXXXXXasXVXXSutbFXXX.jpg_240x240xz.jpg">
```

正则表达式应该写成
‘<img src="(.*)>’


默认贪婪模式

![在这里插入图片描述](/68c79895eb7d478da2203e184e3e02e4.png)

使用非贪婪模式

![在这里插入图片描述](/99e9c144bb674414be82a0de964aa7b1.png)


